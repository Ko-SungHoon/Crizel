<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="crizel">
	<select id="twitter" parameterType="String" resultType="String">
		select
		addr from twitter where name=#{name} order by name
	</select>

	<select id="twitterProc" resultType="com.crizel.common.CrizelVo">
		select * from twitter order
		by name
	</select>
	
	<select id="twitterName" resultType="String">
		select name from twitter order
		by name
	</select>

	<select id="twitterAll" resultType="String">
		select addr from twitter
		order by name
	</select>

	<select id="twitterCount" resultType="int" parameterType="String">
		select
		count(addr) from twitter
	</select>

	<insert id="twitterInsert" parameterType="com.crizel.common.CrizelVo">
		insert into twitter
		values(#{name}, #{addr})
	</insert>

	<delete id="twitterDelete" parameterType="com.crizel.common.CrizelVo">
		delete from twitter
		where name=#{name}
	</delete>
	
	<select id="insta" parameterType="String" resultType="String">
		select
		addr from insta where name=#{name} order by name
	</select>

	<select id="instaProc" resultType="com.crizel.common.CrizelVo">
		select * from insta order
		by name
	</select>
	
	<select id="instaNmae" resultType="String">
		select name from insta order
		by name
	</select>

	<select id="instaAll" resultType="String">
		select addr from insta
		order by name
	</select>

	<select id="instaCount" resultType="int" parameterType="String">
		select
		count(addr) from insta
	</select>

	<insert id="instaInsert" parameterType="com.crizel.common.CrizelVo">
		insert into insta
		values(#{name}, #{addr})
	</insert>

	<delete id="instaDelete" parameterType="com.crizel.common.CrizelVo">
		delete from insta
		where name=#{name}
	</delete>

	<select id="list" resultType="com.crizel.common.CrizelVo" parameterType="String">
		select * 
		from ani 
		where day=#{day} 
		order by ani_time
	</select>

	<insert id="listInsert" parameterType="com.crizel.common.CrizelVo">
		insert into ani(ani_id, title, ani_time, day, keyword, site, directory)
		values((select nvl(max(ani_id)+1,1) from ani), #{title}, #{ani_time}, #{day},
		#{keyword}, #{site}, #{directory})
	</insert>
	
	<select id="listInsertDetail" resultType="com.crizel.common.CrizelVo">
		select * from ani;
	</select>
	
	<update id="lastTitleInsert" parameterType="HashMap">
		UPDATE ANI SET LAST_TITLE = #{title} 
		WHERE ANI_ID = #{ani_id}
	</update>
	
	<select id="lastTitle" parameterType="String" resultType="String">
		SELECT LAST_TITLE
		FROM ANI
		WHERE ANI_ID = #{ani_id}
	</select>
	
	<select id="aniInfo" parameterType="String" resultType="com.crizel.common.CrizelVo">
		SELECT *
		FROM ANI
		WHERE ANI_ID = #{ani_id}
	</select>
	
	<update id="listUpdate" parameterType="com.crizel.common.CrizelVo">
		UPDATE ANI SET
			TITLE = #{title}
			, ANI_TIME = #{ani_time}
			, DAY = #{day}
			, KEYWORD = #{keyword}
			, SITE = #{site}
			, DIRECTORY = #{directory}
		WHERE ANI_ID = #{ani_id}
	</update>
	

	<delete id="listDelete" parameterType="com.crizel.common.CrizelVo">
		delete from ani where
		ani_id=#{ani_id}
	</delete>

	<select id="login" parameterType="com.crizel.common.CrizelVo" resultType="com.crizel.common.CrizelVo">
		select * from login where id=#{id} and pw=#{pw}
	</select>

	<select id="board" parameterType="int" resultType="com.crizel.common.CrizelVo">
		select
		X.rnum, X.nick, X.subject, X.content, X.write_date, X.board_id
		from (
			select rownum as rnum, A.nick, A.subject, A.content,
			A.write_date, A.board_id
			from (
					select nick, subject, content,
					write_date, board_id
					from board
					order by board_id) A
				where rownum <![CDATA[ <= ]]>
			#{pagingCount}) X
		where X.rnum <![CDATA[ >= ]]>
		#{pagingCount}-9
		order by rnum desc
	</select>

	<select id="totalCount" resultType="int">
		select count(*) from board
	</select>

	<insert id="boardInsert" parameterType="com.crizel.common.CrizelVo">
		insert into board
		values((select nvl(max(board_id)+1,1) from board), #{nick}, #{subject}, #{content},
		to_char(sysdate,'yyyy.mm.dd') )
	</insert>

	<select id="boardContent" resultType="com.crizel.common.CrizelVo"
		parameterType="com.crizel.common.CrizelVo">
		select * from board where board_id=#{board_id}
	</select>

	<select id="realFile" resultType="String" parameterType="String">
		select
		realFile from fileUpload where saveFile=#{fileName}
	</select>

	<select id="searchBoardId" resultType="int" parameterType="String">
		select max(board_id) from board
	</select>

	<insert id="fileInsert" parameterType="com.crizel.common.CrizelVo">
		insert into fileUpload
		values((select * from (select ifnull(max(file_id)+1,1) from fileUpload)tmp), #{board_id}, 
		#{file_directory}, #{realFile}, #{saveFile}	)
	</insert>
	
	<select id="fileAllDel" parameterType="com.crizel.common.CrizelVo">
		delete from fileUpload where board_id=#{board_id}
	</select>
	
	<select id="boardContentFile" resultType="com.crizel.common.CrizelVo"
		parameterType="com.crizel.common.CrizelVo">		
		select * from fileUpload where board_id=#{board_id}
	</select>

	<delete id="boardDelete" parameterType="int">
		delete from board where
		board_id=#{board_id}
	</delete>
	
	<delete id="boardFileAllDel" parameterType="int">
		delete from fileUpload where
		board_id=#{board_id}
	</delete>
	
	<update id="boardUpdate" parameterType="com.crizel.common.CrizelVo">
		 update board set nick=#{nick}, subject=#{subject}, content=#{content}, write_date=to_char(sysdate,'yyyy.mm.dd')
		 where board_id=#{board_id}
	</update>
	
	<delete id="boardFileDel" parameterType="com.crizel.common.CrizelVo">
		delete from fileUpload where saveFile=#{saveFile}
	</delete>

	<insert id="register" parameterType="com.crizel.common.CrizelVo">
		insert into login
		values(#{id}, #{pw}, #{name}, #{email}, #{phone}, #{nick},
		to_char(sysdate,'yyyy.mm.dd'))
	</insert>

	<select id="registerCheck" parameterType="String" resultType="String">
		select id from login where id=#{re_id}
	</select>
	
	<select id="json" parameterType="String" resultType="com.crizel.common.CrizelVo">
		select * 
		from girls 
		where name in ('경리', '나나', '설현', '수지', '윤태진')
		<!-- <if test="value != null and !value.equals('')">
			where name like '%'||#{value}||'%' 
		</if> -->
		
		order by name
	</select>
	
	<select id="comicList" resultType="com.crizel.common.CrizelVo">
		select * from comic order by title
	</select>
	
	<insert id="comicInsert" parameterType="com.crizel.common.CrizelVo">
		INSERT INTO COMIC(
			COMIC_ID,
			TITLE,
			ADDR,
			ADDR2
		)
		VALUES(
			(SELECT NVL(MAX(COMIC_ID)+1,1) FROM COMIC),
			#{title},
			#{addr},
			#{addr2}
		)
	</insert>
	
	<delete id="comicDelete" parameterType="com.crizel.common.CrizelVo">
		DELETE FROM COMIC WHERE COMIC_ID = #{comic_id}
	</delete>
	
	<insert id="comicViewCheck" parameterType="HashMap">
		MERGE INTO COMIC_CHECK
		USING DUAL ON(TITLE = #{title})
		WHEN MATCHED THEN
		  UPDATE SET
		    ADDR = #{addr}
		    , REGISTER_DATE  = SYSDATE
		WHEN NOT MATCHED THEN
		  INSERT (CHECK_ID, TITLE, ADDR, REGISTER_DATE)
		  VALUES((SELECT NVL(MAX(CHECK_ID)+1,1) FROM COMIC_CHECK), #{title}, #{addr}, SYSDATE )
	</insert>
	
	<select id="comicViewList" parameterType="String" resultType="com.crizel.common.CrizelVo">
		SELECT 	
			CHECK_ID
			, TITLE
			, ADDR
			, TO_CHAR(REGISTER_DATE, 'YYYY-MM-DD') AS REGISTER_DATE
		FROM COMIC_CHECK
		WHERE ADDR = #{addr}
		ORDER BY TITLE
	</select>
</mapper>