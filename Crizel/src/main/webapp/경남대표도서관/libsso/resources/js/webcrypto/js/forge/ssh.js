!function(){function e(e){function t(t,r){var n=r.toString(16);n[0]>="8"&&(n="00"+n);var i=e.util.hexToBytes(n);t.putInt32(i.length),t.putBytes(i)}function r(e,t){e.putInt32(t.length),e.putString(t)}function n(){for(var t=e.md.sha1.create(),r=arguments.length,n=0;r>n;++n)t.update(arguments[n]);return t.digest()}var i=e.ssh=e.ssh||{};i.privateKeyToPutty=function(i,u,a){a=a||"",u=u||"";var f="ssh-rsa",o=""===u?"none":"aes256-cbc",c="PuTTY-User-Key-File-2: "+f+"\r\n";c+="Encryption: "+o+"\r\n",c+="Comment: "+a+"\r\n";var l=e.util.createBuffer();r(l,f),t(l,i.e),t(l,i.n);var s=e.util.encode64(l.bytes(),64),p=Math.floor(s.length/66)+1;c+="Public-Lines: "+p+"\r\n",c+=s;var d=e.util.createBuffer();t(d,i.d),t(d,i.p),t(d,i.q),t(d,i.qInv);var y;if(u){var g=d.length()+16-1;g-=g%16;var v=n(d.bytes());v.truncate(v.length()-g+d.length()),d.putBuffer(v);var h=e.util.createBuffer();h.putBuffer(n("\x00\x00\x00\x00",u)),h.putBuffer(n("\x00\x00\x00",u));var m=e.aes.createEncryptionCipher(h.truncate(8),"CBC");m.start(e.util.createBuffer().fillWithByte(0,16)),m.update(d.copy()),m.finish();var B=m.output;B.truncate(16),y=e.util.encode64(B.bytes(),64)}else y=e.util.encode64(d.bytes(),64);p=Math.floor(y.length/66)+1,c+="\r\nPrivate-Lines: "+p+"\r\n",c+=y;var x=n("putty-private-key-file-mac-key",u),b=e.util.createBuffer();r(b,f),r(b,o),r(b,a),b.putInt32(l.length()),b.putBuffer(l),b.putInt32(d.length()),b.putBuffer(d);var P=e.hmac.create();return P.start("sha1",x),P.update(b.bytes()),c+="\r\nPrivate-MAC: "+P.digest().toHex()+"\r\n"},i.publicKeyToOpenSSH=function(n,i){var u="ssh-rsa";i=i||"";var a=e.util.createBuffer();return r(a,u),t(a,n.e),t(a,n.n),u+" "+e.util.encode64(a.bytes())+" "+i},i.privateKeyToOpenSSH=function(t,r){return r?e.pki.encryptRsaPrivateKey(t,r,{legacy:!0,algorithm:"aes128"}):e.pki.privateKeyToPem(t)},i.getPublicKeyFingerprint=function(n,i){i=i||{};var u=i.md||e.md.md5.create(),a="ssh-rsa",f=e.util.createBuffer();r(f,a),t(f,n.e),t(f,n.n),u.start(),u.update(f.getBytes());var o=u.digest();if("hex"===i.encoding){var c=o.toHex();return i.delimiter?c.match(/.{2}/g).join(i.delimiter):c}if("binary"===i.encoding)return o.getBytes();if(i.encoding)throw new Error('Unknown encoding "'+i.encoding+'".');return o}}var t="ssh";if("function"!=typeof define){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),e(forge);var r=!0;define=function(e,t){t(require,module)}}var n,i=function(r,i){i.exports=function(i){var u=n.map(function(e){return r(e)}).concat(e);if(i=i||{},i.defined=i.defined||{},i.defined[t])return i[t];i.defined[t]=!0;for(var a=0;a<u.length;++a)u[a](i);return i[t]}},u=define;define=function(e,t){return n="string"==typeof e?t.slice(2):e.slice(2),r?(delete define,u.apply(null,Array.prototype.slice.call(arguments,0))):(define=u,define.apply(null,Array.prototype.slice.call(arguments,0)))},define(["require","module","./aes","./hmac","./md5","./sha1","./util"],function(){i.apply(null,Array.prototype.slice.call(arguments,0))})}();