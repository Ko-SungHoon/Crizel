/**
 * RC2 implementation.
 *
 * @author Stefan Siegl
 *
 * Copyright (c) 2012 Stefan Siegl <stesie@brokenpipe.de>
 *
 * Information on the RC2 cipher is available from RFC #2268,
 * http://www.ietf.org/rfc/rfc2268.txt
 */
!function(){function e(e){var t=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],r=[1,2,3,5],n=function(e,t){return e<<t&65535|(65535&e)>>16-t},u=function(e,t){return(65535&e)>>t|e<<16-t&65535};e.rc2=e.rc2||{},e.rc2.expandKey=function(r,n){"string"==typeof r&&(r=e.util.createBuffer(r)),n=n||128;var u,f=r,i=r.length(),o=n,c=Math.ceil(o/8),a=255>>(7&o);for(u=i;128>u;u++)f.putByte(t[f.at(u-1)+f.at(u-i)&255]);for(f.setAt(128-c,t[f.at(128-c)&a]),u=127-c;u>=0;u--)f.setAt(u,t[f.at(u+1)^f.at(u+c)]);return f};var f=function(t,f,i){var o,c,a,l,p=!1,d=null,s=null,y=null,g=[];for(t=e.rc2.expandKey(t,f),a=0;64>a;a++)g.push(t.getInt16Le());i?(o=function(e){for(a=0;4>a;a++)e[a]+=g[l]+(e[(a+3)%4]&e[(a+2)%4])+(~e[(a+3)%4]&e[(a+1)%4]),e[a]=n(e[a],r[a]),l++},c=function(e){for(a=0;4>a;a++)e[a]+=g[63&e[(a+3)%4]]}):(o=function(e){for(a=3;a>=0;a--)e[a]=u(e[a],r[a]),e[a]-=g[l]+(e[(a+3)%4]&e[(a+2)%4])+(~e[(a+3)%4]&e[(a+1)%4]),l--},c=function(e){for(a=3;a>=0;a--)e[a]-=g[63&e[(a+3)%4]]});var v=function(e){var t=[];for(a=0;4>a;a++){var r=d.getInt16Le();null!==y&&(i?r^=y.getInt16Le():y.putInt16Le(r)),t.push(65535&r)}l=i?0:63;for(var n=0;n<e.length;n++)for(var u=0;u<e[n][0];u++)e[n][1](t);for(a=0;4>a;a++)null!==y&&(i?y.putInt16Le(t[a]):t[a]^=y.getInt16Le()),s.putInt16Le(t[a])},h=null;return h={start:function(t,r){t&&"string"==typeof t&&(t=e.util.createBuffer(t)),p=!1,d=e.util.createBuffer(),s=r||new e.util.createBuffer,y=t,h.output=s},update:function(e){for(p||d.putBuffer(e);d.length()>=8;)v([[5,o],[1,c],[6,o],[1,c],[5,o]])},finish:function(e){var t=!0;if(i)if(e)t=e(8,d,!i);else{var r=8===d.length()?8:8-d.length();d.fillWithByte(r,r)}if(t&&(p=!0,h.update()),!i&&(t=0===d.length()))if(e)t=e(8,s,!i);else{var n=s.length(),u=s.at(n-1);u>n?t=!1:s.truncate(u)}return t}}};e.rc2.startEncrypting=function(t,r,n){var u=e.rc2.createEncryptionCipher(t,128);return u.start(r,n),u},e.rc2.createEncryptionCipher=function(e,t){return f(e,t,!0)},e.rc2.startDecrypting=function(t,r,n){var u=e.rc2.createDecryptionCipher(t,128);return u.start(r,n),u},e.rc2.createDecryptionCipher=function(e,t){return f(e,t,!1)}}var t="rc2";if("function"!=typeof define){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),e(forge);var r=!0;define=function(e,t){t(require,module)}}var n,u=function(r,u){u.exports=function(u){var f=n.map(function(e){return r(e)}).concat(e);if(u=u||{},u.defined=u.defined||{},u.defined[t])return u[t];u.defined[t]=!0;for(var i=0;i<f.length;++i)f[i](u);return u[t]}},f=define;define=function(e,t){return n="string"==typeof e?t.slice(2):e.slice(2),r?(delete define,f.apply(null,Array.prototype.slice.call(arguments,0))):(define=f,define.apply(null,Array.prototype.slice.call(arguments,0)))},define(["require","module","./util"],function(){u.apply(null,Array.prototype.slice.call(arguments,0))})}();