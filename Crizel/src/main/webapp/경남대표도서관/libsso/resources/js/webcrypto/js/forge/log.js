/**
 * Cross-browser support for logging in a web application.
 *
 * @author David I. Lehn <dlehn@digitalbazaar.com>
 *
 * Copyright (c) 2008-2013 Digital Bazaar, Inc.
 */
!function(){function e(e){e.log=e.log||{},e.log.levels=["none","error","warning","info","debug","verbose","max"];var l={},o=[],n=null;e.log.LEVEL_LOCKED=2,e.log.NO_LEVEL_CHECK=4,e.log.INTERPOLATE=8;for(var r=0;r<e.log.levels.length;++r){var a=e.log.levels[r];l[a]={index:r,name:a.toUpperCase()}}e.log.logMessage=function(n){for(var r=l[n.level].index,a=0;a<o.length;++a){var g=o[a];if(g.flags&e.log.NO_LEVEL_CHECK)g.f(n);else{var t=l[g.level].index;t>=r&&g.f(g,n)}}},e.log.prepareStandard=function(e){"standard"in e||(e.standard=l[e.level].name+" ["+e.category+"] "+e.message)},e.log.prepareFull=function(l){if(!("full"in l)){var o=[l.message];o=o.concat([]||l.arguments),l.full=e.util.format.apply(this,o)}},e.log.prepareStandardFull=function(l){"standardFull"in l||(e.log.prepareStandard(l),l.standardFull=l.standard)};for(var g=["error","warning","info","debug","verbose"],r=0;r<g.length;++r)!function(l){e.log[l]=function(o,n){var r=Array.prototype.slice.call(arguments).slice(2),a={timestamp:new Date,level:l,category:o,message:n,arguments:r};e.log.logMessage(a)}}(g[r]);if(e.log.makeLogger=function(l){var o={flags:0,f:l};return e.log.setLevel(o,"none"),o},e.log.setLevel=function(l,o){var n=!1;if(l&&!(l.flags&e.log.LEVEL_LOCKED))for(var r=0;r<e.log.levels.length;++r){var a=e.log.levels[r];if(o==a){l.level=o,n=!0;break}}return n},e.log.lock=function(l,o){"undefined"==typeof o||o?l.flags|=e.log.LEVEL_LOCKED:l.flags&=~e.log.LEVEL_LOCKED},e.log.addLogger=function(e){o.push(e)},"undefined"!=typeof console&&"log"in console){var t;if(console.error&&console.warn&&console.info&&console.debug){var i={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug},s=function(l,o){e.log.prepareStandard(o);var n=i[o.level],r=[o.standard];r=r.concat(o.arguments.slice()),n.apply(console,r)};t=e.log.makeLogger(s)}else{var s=function(l,o){e.log.prepareStandardFull(o),console.log(o.standardFull)};t=e.log.makeLogger(s)}e.log.setLevel(t,"debug"),e.log.addLogger(t),n=t}else console={log:function(){}};if(null!==n){var f=e.util.getQueryVariables();if("console.level"in f&&e.log.setLevel(n,f["console.level"].slice(-1)[0]),"console.lock"in f){var u=f["console.lock"].slice(-1)[0];"true"==u&&e.log.lock(n)}}e.log.consoleLogger=n}var l="log";if("function"!=typeof define){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),e(forge);var o=!0;define=function(e,l){l(require,module)}}var n,r=function(o,r){r.exports=function(r){var a=n.map(function(e){return o(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[l])return r[l];r.defined[l]=!0;for(var g=0;g<a.length;++g)a[g](r);return r[l]}},a=define;define=function(e,l){return n="string"==typeof e?l.slice(2):e.slice(2),o?(delete define,a.apply(null,Array.prototype.slice.call(arguments,0))):(define=a,define.apply(null,Array.prototype.slice.call(arguments,0)))},define(["require","module","./util"],function(){r.apply(null,Array.prototype.slice.call(arguments,0))})}();