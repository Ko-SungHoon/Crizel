<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="ERPGoodsManage">
	<cacheModel type="${Globals.ibatis.default.cache}" id="ERPGoodsManageManageCache" readOnly="true" serialize="false">
		<flushInterval hours="24" />
      	<flushOnExecute statement="erpDAO.deleteBizProd"/>
      	<flushOnExecute statement="erpDAO.updateTBizPartner"/>
      	<flushOnExecute statement="erpDAO.insertFarmDiary"/>
		<flushOnExecute statement="erpDAO.updateFarmDiary"/>
		<flushOnExecute statement="erpDAO.deleteFarmDiary"/>
		<flushOnExecute statement="erpDAO.insertFarmDiarySub"/>
		<flushOnExecute statement="erpDAO.deleteFarmDiarySub"/>
	</cacheModel>
	
	<typeAlias  alias="packMainVO" type = "egovframework.rfc3.fooderp.vo.PackMainVO"/>
	<typeAlias  alias="deliveryPlanVO" type = "egovframework.rfc3.fooderp.vo.DeliveryPlanVO"/>
	<typeAlias  alias="codeMstSubVO" type = "egovframework.rfc3.fooderp.vo.CodeMstSubVO"/>
	<typeAlias  alias="planSubVO" type = "egovframework.rfc3.fooderp.vo.PlanSubVO"/>	
	<typeAlias  alias="PartnerVO" type = "egovframework.rfc3.fooderp.vo.PartnerVO"/>
	<typeAlias  alias="ProdMstVO" type = "egovframework.rfc3.fooderp.vo.ProdMstVO"/>
	<typeAlias  alias="CodeMstVO" type = "egovframework.rfc3.fooderp.vo.CodeMstVO"/>
	<typeAlias  alias="ProdDivision" type = "egovframework.rfc3.fooderp.vo.ProdDivision"/>
	<typeAlias  alias="FarmMstVO" type = "egovframework.rfc3.fooderp.vo.FarmMstVO"/>
	<typeAlias  alias="loginVO" type = "egovframework.rfc3.login.vo.LoginVO"/>
	<typeAlias  alias="ProdContractVO" type = "egovframework.rfc3.fooderp.vo.ProdContractVO"/>

	<typeAlias  alias="OrderIngVO" type = "egovframework.rfc3.fooderp.vo.OrderIngVO"/>
	<typeAlias  alias="pesticideVO" type = "egovframework.rfc3.fooderp.vo.PesticideVO"/>
	
	
	
	<cacheModel type="${Globals.ibatis.default.cache}" id="ERPGoodsManageManageCache" readOnly="true" serialize="false">
		<flushInterval hours="24" />
      	<flushOnExecute statement="erpDAO.deleteBizProd"/>
      	<flushOnExecute statement="erpDAO.updateTBizPartner"/>
	</cacheModel>
	


	<typeAlias  alias="farmingVO" type = "egovframework.rfc3.fooderp.vo.FarmingVO"/>
	<typeAlias  alias="farmingSubVO" type = "egovframework.rfc3.fooderp.vo.FarmingSubVO"/>

	
	
	<select id="erpDAO.selectPackCode"  parameterClass="packMainVO" resultClass="packMainVO" cacheModel="ERPGoodsManageManageCache">
		SELECT * 
		  FROM 
		       (SELECT ROWNUM RNUM, 
		              ALL_LIST.* 
		         FROM 
		              (SELECT 
		              		packNo,
							packDate,
							packTypeCd,
							register,
							weekOrder,
							year,
							regiDate
		                FROM T_PACK_MAIN
		               
		              ) ALL_LIST 
		       ) 
		 WHERE RNUM &gt; #firstIndex# AND RNUM &lt;= #firstIndex# + #recordCountPerPage# 
	</select>
	<select id="erpDAO.selectPackCodeTotal"  parameterClass="packMainVO" resultClass="int" cacheModel="ERPGoodsManageManageCache">
	SELECT 
		COUNT(*) totcnt		
	FROM T_PACK_MAIN
	</select>
	
	<select id="erpDAO.selectDeliveryPlan"  parameterClass="deliveryPlanVO" resultClass="deliveryPlanVO" cacheModel="ERPGoodsManageManageCache">
		SELECT
			deliSid,
			deadLineYN,
			deliConNm,
			deliIndex,
			deliKindCd,
			deliPlanDate,
			deliPlanWeekDay,
			deliTotIndex,
			editDate,
			editor,
			invoiceNo,
			memId,
			memoYN,
			multiOrderNo,
			orderDate,
			orderNo,
			packTypeCd,
			prodOrderYN,
			receiveAddr,
			receiveDetailAddr,
			receiveMobileNo,
			receiveNm,
			receivePostNo,
			receiveTelNo,
			regiDate,
			register,
			shipmentNo,
			statusCd
		FROM T_DELIVERY_PLAN
		WHERE orderNo = #orderNo# 
		ORDER BY deliPlanDate ASC
	</select>
	
	<select id="erpDAO.getDeliveryPlan"  parameterClass="deliveryPlanVO" resultClass="deliveryPlanVO" cacheModel="ERPGoodsManageManageCache">
		SELECT
			deliSid,
			deadLineYN,
			deliConNm,
			deliIndex,
			deliKindCd,
			deliPlanDate,
			deliPlanWeekDay,
			deliTotIndex,
			editDate,
			editor,
			invoiceNo,
			memId,
			memoYN,
			multiOrderNo,
			orderDate,
			orderNo,
			packTypeCd,
			prodOrderYN,
			receiveAddr,
			receiveDetailAddr,
			receiveMobileNo,
			receiveNm,
			receivePostNo,
			receiveTelNo,
			regiDate,
			register,
			shipmentNo,
			statusCd
		FROM T_DELIVERY_PLAN
		WHERE deliSid = #deliSid# 
		ORDER BY deliIndex
	</select>
	
	<select id="erpDAO.selectCodeMstSubTotal"  resultClass="int" cacheModel="ERPGoodsManageManageCache">
		SELECT 
			COUNT(*) totcnt		
		FROM T_CODE_MST_SUB
		WHERE
			MAINCD = '11'
	</select>
	
	<select id="erpDAO.selectCodeMstSub"  resultClass="codeMstSubVO" cacheModel="ERPGoodsManageManageCache">
		SELECT 
			MAINCD mainCd,
			SUBCD subCd,
			SUBNM subNm,
			SUBCDVALUE	subCdValue	
		FROM T_CODE_MST_SUB
		WHERE
			MAINCD = '11'
	</select>
	
	<select id="erpDAO.selectDeliveryPlanSubTotal"  parameterClass="deliveryPlanVO" resultClass="int" cacheModel="ERPGoodsManageManageCache">
		SELECT
			COUNT(*) totcnt
		FROM T_DELIVERY_PLAN_SUB
		WHERE deliSid = #deliSid# 
	</select>
	
	<select id="erpDAO.selectDeliveryPlanSubList"  parameterClass="deliveryPlanVO" resultClass="planSubVO" cacheModel="ERPGoodsManageManageCache">
		SELECT
			SUB.deliSid,
			SUB.packNo,
			SUB.prodCd,
			SUB.packunitamt,
			SUB.packunitcd,
			SUB.unitprice,
			MST.prodnm,
			MST.standard
		FROM
			T_DELIVERY_PLAN_SUB SUB INNER JOIN T_PROD_MST MST
			ON SUB.prodcd = MST.prodcd
		WHERE deliSid = #deliSid# 
		ORDER BY packunitamt ASC
	</select>
	
	<select id="erpDAO.selectDeliveryPlanPackList"  parameterClass="deliveryPlanVO" resultClass="planSubVO" cacheModel="ERPGoodsManageManageCache">
		SELECT
			SUB.packNo,
			SUB.prodCd,
			SUB.packunitamt,
			SUB.packunitcd,
			SUB.unitprice,
			MST.prodnm,
			MST.standard
		FROM T_PACK_MAIN MAIN 
		   INNER JOIN T_PACK_SUB SUB 
		       ON MAIN.packno = SUB.packno 
		   INNER JOIN T_PROD_MST MST 
		       ON SUB.prodcd = MST.prodcd		
		WHERE MAIN.packtypecd= #packTypeCd# AND MAIN.packdate = #deliPlanDate#
	</select>
	
	<select id="erpDAO.selectDeliveryPlanChangeList"  parameterClass="deliveryPlanVO" resultClass="planSubVO" cacheModel="ERPGoodsManageManageCache">
		SELECT MAIN.packNo, 
		       CHN.prodCd, 
		       CHN.packunitamt, 
		       CHN.packunitcd, 
		       CHN.unitprice, 
		       MST.prodnm, 
		       MST.standard 
		  FROM T_PACK_MAIN MAIN 
		   INNER JOIN T_PROD_CHANGE_MST CHN 
		       ON MAIN.PACKDATE = CHN.DELIPLANDATE 
		   INNER JOIN T_PROD_MST MST 
		       ON CHN.PRODCD = MST.PRODCD
		WHERE MAIN.packtypecd= #packTypeCd# AND MAIN.packdate = #deliPlanDate#
	</select>
	<insert id="erpDAO.insertDeliveryPlanSub"  parameterClass="planSubVO">
		INSERT INTO T_DELIVERY_PLAN_SUB
		(
			DELISID,
			PACKNO,
			PRODCD,
			PACKUNITAMT,
			PACKUNITCD,
			UNITPRICE
		)
		VALUES
		(
			#deliSid#,
			#packNo#,
			#prodCd#,
			#packunitamt#,
			#packunitcd#,
			#unitprice#						
		)
	</insert>
	
	<delete id="erpDAO.deleteDeliveryPlanSub"  parameterClass="deliveryPlanVO">
		DELETE
		FROM
			T_DELIVERY_PLAN_SUB
		WHERE
			deliSid = #deliSid#
	</delete>
	
	<select id="erpDAO.selectDeliverySubTradeInfo"  parameterClass="deliveryPlanVO" resultClass="planSubVO" cacheModel="ERPGoodsManageManageCache">
		SELECT MST.PRODNM prodnm, 
		       MST.STANDARD standard, 
		       INFO.STATUSNM statusNm,
		       INFO.PARTNERCD partnerCd,
		       INFO.STATUSREGIDATE statusRegiDate,
		       PARTNER.PARTNERNM partnerNm
		  FROM T_DELIVERY_PLAN PLAN 
		   INNER JOIN T_DELIVERY_PLAN_SUB SUB 
		       ON PLAN.DELISID = SUB.DELISID 
		   INNER JOIN T_PROD_MST MST 
		       ON SUB.PRODCD = MST.PRODCD 
		   LEFT OUTER JOIN T_TRACE_INFO INFO 
		       ON PLAN.SHIPMENTNO = INFO.SHIPMENTNO
		   LEFT OUTER JOIN T_BIZ_PARTNER PARTNER 
		       ON INFO.PARTNERCD = PARTNER.PARTNERCD
		WHERE
			PLAN.DELISID = #deliSid#	  
	</select>
	
	<select id="erpDAO.selectTradeInfo"  parameterClass="deliveryPlanVO" resultClass="planSubVO" cacheModel="ERPGoodsManageManageCache">
		SELECT PRODCD prodCd, 
	       STATUSNM statusNm, 
	       TO_CHAR(STATUSREGIDATE, 'yyyy-mm-dd HH24:MI') statusDate, 
	       (SELECT PRODNM 
	         FROM T_PROD_MST 
	        WHERE PRODCD = TI.PRODCD
	       ) prodnm, 
		(SELECT BZ.FILENM 
		FROM T_BIZ_PARTNER BZ 
		WHERE BZ.PARTNERCD = TI.PARTNERCD
		) AS fileNm,
		(SELECT BZ.INTRODUCTION 
		FROM T_BIZ_PARTNER BZ 
		WHERE BZ.PARTNERCD = TI.PARTNERCD 
		)  AS introduction,
	       (SELECT SUBSTR(XMLAGG(XMLELEMENT(a,',' || PARTNERNM ||'('||ADDR||')') 
	     ORDER BY PARTNERNM).EXTRACT('//text()'), 2) 
	         FROM 
	              (SELECT PS.PARTNERCD, 
	                     PRODCD 
	                FROM T_PICKING_STANDBY PS 
	               WHERE PS.PICKINGDATE =#deliPlanDate#
	               GROUP BY PRODCD, 
	                     PARTNERCD 
	              ) PS 
	          INNER JOIN T_BIZ_PARTNER BP 
	              ON PS.PARTNERCD = BP.PARTNERCD 
	        WHERE PS.PRODCD = TI.PRODCD ) partnerNm 
	         FROM T_TRACE_INFO TI 
	        WHERE SHIPMENTNO = #shipmentNo#
	     ORDER BY PRODCD;
   </select>
	
	<select id="erpDAO.selectDeliveryTradeInfo"  parameterClass="deliveryPlanVO" resultClass="planSubVO" cacheModel="ERPGoodsManageManageCache">
		SELECT MST.PRODNM prodnm, 
		       MST.STANDARD standard, 
		       INFO.STATUSNM statusNm,
		       INFO.PARTNERCD partnerCd,
		       INFO.STATUSREGIDATE statusRegiDate,
		       PARTNER.PARTNERNM partnerNm
		  FROM T_DELIVERY_PLAN PLAN 
		   INNER JOIN T_PACK_MAIN MAIN 
		       ON PLAN.PACKTYPECD = MAIN.PACKTYPECD 
		       AND PLAN.DELIPLANDATE = MAIN.PACKDATE 
		   INNER JOIN T_PACK_SUB SUB 
		       ON MAIN.PACKNO = SUB.PACKNO 
		   INNER JOIN T_PROD_MST MST 
		       ON SUB.PRODCD = MST.PRODCD 
		   LEFT OUTER JOIN T_TRACE_INFO INFO 
		       ON PLAN.SHIPMENTNO = INFO.SHIPMENTNO
		   LEFT OUTER JOIN T_BIZ_PARTNER PARTNER 
		       ON INFO.PARTNERCD = PARTNER.PARTNERCD
		WHERE
			PLAN.DELISID = #deliSid# 
	</select>
	
	<select id="erpDAO.selectPesticideInfo"  parameterClass="pesticideVO" resultClass="pesticideVO" cacheModel="ERPGoodsManageManageCache">
		SELECT 
			PARNTER.PARTNERNM partnerNm,
		    MST.PRODNM prodNm,
		    CIDE.TESTER tester,
		    CIDE.FILENM fileNm,
		    CIDE.CENTERINDATE centerinDate,
		    CIDE.ISSUEDATE issueDate
		FROM
			T_PESTICIDE CIDE INNER JOIN T_BIZ_PARTNER PARNTER
			ON CIDE.PARTNERCD = PARNTER.PARTNERCD
			INNER JOIN T_PROD_MST MST
			ON CIDE.PRODCD = MST.PRODCD 
		WHERE
			CIDE.ISSUEDATE = #date#
			<isNotEmpty prepend="AND" property="prodCd" >
				MST.CENTERINDATE = #prodCd#
			</isNotEmpty>
	</select>
	<!-- ************************************************************************  P H M ************************************************************************  -->
	<!-- phm partner list -->
	<select id="erpDAO.selectPartner"  parameterClass="PartnerVO" resultClass="PartnerVO" cacheModel="ERPGoodsManageManageCache">
	SELECT * 
		  FROM 
		       (SELECT ROWNUM RNUM, 
		              ALL_LIST.* 
		         FROM 
		              (SELECT 
		              		partnerCd			,
							partnerNm			,
							partnerTypeCd	,
							villageNm				,
							partnerCeo			,
							juMin1					,
							juMin2					,
							businessNo			,
							telNo,
							mobileNo				,
							postNo					,
							addr						,
							detailAddr			,
							bankCd				,
							accountNo			,
							useYn					,
							regiDate				,
							regisTer
		                FROM T_BIZ_PARTNER
		                WHERE 
		                PARTNERCD = #partnerCd#
		               <isNotEmpty prepend="AND" property="searchCondition" >
			          		     $searchCondition$  LIKE '%$searchKeyword$%'
			            </isNotEmpty>
		              ) ALL_LIST 
		       ) 
		 WHERE RNUM &gt; #firstIndex# AND RNUM &lt;= #firstIndex# + #recordCountPerPage#
	</select>
	
	<select id="erpDAO.selectPartnerTotal"  parameterClass="PartnerVO" resultClass="int" cacheModel="ERPGoodsManageManageCache">
	SELECT 
		COUNT(*) totcnt		
	FROM T_BIZ_PARTNER
	 WHERE  PARTNERCD = #partnerCd#
      <isNotEmpty prepend="AND" property="searchCondition" >
  		     $searchCondition$  LIKE '%$searchKeyword$%'
    </isNotEmpty>
	</select>
	
	<select id="erpDAO.viewSelectPartner"  parameterClass="PartnerVO" resultClass="PartnerVO" cacheModel="ERPGoodsManageManageCache">
		SELECT
							partnerCd			,
							partnerNm			,
							partnerTypeCd	,
							villageNm				,
							partnerCeo			,
							juMin1					,
							juMin2					,
							businessNo			,
							telNo					,
							mobileNo				,
							postNo					,
							addr						,
							detailAddr			,
							bankCd				,
							accountNo			,
							useYn					,
							regiDate				,
							regisTer
		FROM T_BIZ_PARTNER
		WHERE partnerCd = #partnerCd# 
		ORDER BY partnerCd
	</select>
	
	<insert id="erpDAO.insertPartner"  parameterClass="PartnerVO">
		INSERT INTO T_BIZ_PARTNER
		(
			PARTNERCD,
			PARTNERNM,
			PARTNERTYPECD,
			VILLAGENM,
			PARTNERCEO,
			JUMIN1,
			JUMIN2,
			BUSINESSNO,
			TELNO,
			MOBILENO,
			POSTNO,
			ADDR,
			DETAILADDR,
			BANKCD,
			ACCOUNTNO,
			USEYN,
			REGIDATE,
			REGISTER
		)
		VALUES
		(
			#partnerCd#		,
			#partnerNm#		,
			#partnerTypeCd#	,
			#villageNm#		,
			#partnerCeo#		,
			#juMin1#			,
			#juMin2#			,
			#businessNo#		,
			#telNo#			,
			#mobileNo#		,
			#postNo#			,
			#addr#			,
			#detailAddr#		,
			#bankCd#			,
			#accountNo#		,
			#useYn#			,
			#regiDate#		,
			#regisTer#				
		)
	</insert>
	
	
	
	<select id="erpDAO.selectProd_Mst"  parameterClass="ProdMstVO" resultClass="ProdMstVO" cacheModel="ERPGoodsManageManageCache">
		SELECT 
			BIZ.PARTNERCD,
		    BIZ.PRODCD,
		    BIZ.REGIDATE,
		    BIZ.REGISTER,
		   	MST.PRODCD,
		    MST.DIVCD,
		    MST.CLASSCD,
		    MST.PRODNM,
		    MST.UNITCD,
		    MST.STANDARD,
		    MST.CONTAINERTYPECD,
		    MST.STORAGECD,
		    MST.SUBDIVISIONYN,
		    MST.WASHYN,
		    MST.STORAGELIMITDAY,
		    MST.MAXSTORAGEDAY,
		    MST.SAFESTOCKAMT,
		    MST.LEADTIME,
		    MST.USEYN,
		    MST.INDEXCD,
		    MST.CONUSECNT
		FROM T_BIZ_PROD BIZ
		INNER JOIN T_PROD_MST MST
		ON BIZ.PRODCD = MST.PRODCD 
		WHERE 	BIZ.PARTNERCD = #partnerCd#
	</select>
	
	<select id="erpDAO.selectCodeMstVO"  parameterClass="CodeMstVO" resultClass="CodeMstVO" cacheModel="ERPGoodsManageManageCache">
			SELECT 
				MCODE.MAINCD,
				MCODE.MAINNM,
				SCODE.SUBCD,
				SCODE.SUBNM,
				SCODE.SUBCDVALUE
			FROM  T_CODE_MST_MAIN MCODE  
			INNER JOIN T_CODE_MST_SUB SCODE
			ON MCODE.MAINCD = SCODE.MAINCD 
			WHERE 
			MCODE.MAINCD = #mainCd#
	</select>
	
	<select id="erpDAO.selectCodeSearch"  parameterClass="ProdMstVO" resultClass="ProdMstVO" cacheModel="ERPGoodsManageManageCache">
	SELECT 
			BIZ.PARTNERCD,
		    BIZ.PRODCD,
		    BIZ.REGIDATE,
		    BIZ.REGISTER,
		   	MST.PRODCD,
		    MST.DIVCD,
		    MST.CLASSCD,
		    MST.PRODNM,
		    MST.UNITCD,
		    MST.STANDARD,
		    MST.CONTAINERTYPECD,
		    MST.STORAGECD,
		    MST.SUBDIVISIONYN,
		    MST.WASHYN,
		    MST.STORAGELIMITDAY,
		    MST.MAXSTORAGEDAY,
		    MST.SAFESTOCKAMT,
		    MST.LEADTIME,
		    MST.USEYN,
		    MST.INDEXCD,
		    MST.CONUSECNT
		FROM T_BIZ_PROD BIZ
		INNER JOIN T_PROD_MST MST
		ON BIZ.PRODCD = MST.PRODCD 
		WHERE 1=1
			
			 <isNotEmpty prepend="AND" property="searchKey1" >
  		     	MST.DIVCD = #searchKey1#
   			 </isNotEmpty>
   			 <isNotEmpty prepend="AND" property="searchKey2" >
  		     	MST.CLASSCD = #searchKey2# 
   			 </isNotEmpty>
   			 <isNotEmpty prepend="AND" property="searchKey3" >
  		     	MST.PRODCD  LIKE '%$searchKey3$%'
   			 </isNotEmpty>
   			 <isNotEmpty prepend="AND" property="searchKey4" >
  		     	MST.PRODNM  LIKE '%$searchKey4$%'
   			 </isNotEmpty>
   			  <isNotEmpty prepend="AND" property="partnerCd" >
  		     	BIZ.PARTNERCD =	#partnerCd#
   			 </isNotEmpty>
	</select>
	
	<select id="erpDAO.selectCodeSearchList"  parameterClass="ProdMstVO" resultClass="ProdMstVO" cacheModel="ERPGoodsManageManageCache">
		SELECT 
			   	MST.PRODCD,
			    MST.DIVCD,
			    MST.CLASSCD,
			    MST.PRODNM,
			    MST.UNITCD,
			    MST.STANDARD,
			    MST.CONTAINERTYPECD,
			    MST.STORAGECD,
			    MST.SUBDIVISIONYN,
			    MST.WASHYN,
			    MST.STORAGELIMITDAY,
			    MST.MAXSTORAGEDAY,
			    MST.SAFESTOCKAMT,
			    MST.LEADTIME,
			    MST.USEYN,
			    MST.INDEXCD,
			    MST.CONUSECNT
			FROM T_PROD_MST MST
			WHERE 1=1
			
			 <isNotEmpty prepend="AND" property="searchKey1" >
  		     	MST.DIVCD = #searchKey1#
   			 </isNotEmpty>
   			 <isNotEmpty prepend="AND" property="searchKey2" >
  		     	MST.CLASSCD = #searchKey2# 
   			 </isNotEmpty>
   			 <isNotEmpty prepend="AND" property="searchKey3" >
  		     	MST.PRODCD  LIKE '%$searchKey3$%'
   			 </isNotEmpty>
   			 <isNotEmpty prepend="AND" property="searchKey4" >
  		     	MST.PRODNM  LIKE '%$searchKey4$%'
   			 </isNotEmpty>
	</select>

	<select id="erpDAO.selectProdDivisionVO"  parameterClass="ProdDivision" resultClass="ProdDivision" cacheModel="ERPGoodsManageManageCache">
			SELECT 
				DIV1.DIVCD,
				DIV1.DIVNM,
				DIV2.CLASSCD,
				DIV2.CLASSNM
				FROM T_PROD_DIVISION1 DIV1
				INNER JOIN T_PROD_DIVISION2 DIV2
				ON
				DIV1.DIVCD = DIV2.DIVCD
			WHERE
				DIV1.DIVCD = #divCd#
	</select>
	
		<select id="erpDAO.selectProdDivisionVOLists"  parameterClass="ProdDivision" resultClass="ProdDivision" cacheModel="ERPGoodsManageManageCache">
			SELECT 
				DIV1.DIVCD,
				DIV1.DIVNM,
				DIV2.CLASSCD,
				DIV2.CLASSNM
				FROM T_PROD_DIVISION1 DIV1
				INNER JOIN T_PROD_DIVISION2 DIV2
				ON
				DIV1.DIVCD = DIV2.DIVCD
            	WHERE 1=1
			
			 <isNotEmpty prepend="AND" property="searchKey1" >
  		     	DIV1.DIVCD = #searchKey1#
   			 </isNotEmpty>
   			  <isNotEmpty prepend="AND" property="searchKey2" >
  		     	DIV2.CLASSCD = #searchKey2#
   			 </isNotEmpty>
   			  <isNotEmpty prepend="AND" property="searchKey3" >
  		     	DIV2.CLASSCD = #searchKey3#
   			 </isNotEmpty>
   			 <isNotEmpty prepend="AND" property="searchKey4" >
  		     	DIV2.CLASSNM  LIKE '%$searchKey4$%'
   			 </isNotEmpty>
	</select>
	
	<select id="erpDAO.selectProdDivisionVOList"  parameterClass="ProdDivision" resultClass="ProdDivision" cacheModel="ERPGoodsManageManageCache">
			SELECT 
				DIV1.DIVCD,
				DIV1.DIVNM
				FROM T_PROD_DIVISION1 DIV1
	</select>
	
	<select id="erpDAO.selectFarmMstVOList"  parameterClass="FarmMstVO" resultClass="FarmMstVO" cacheModel="ERPGoodsManageManageCache">
			SELECT 
				FARMSID,
				PARTNERCD,
				FARMNM,
				POSTNO,
				ADDR,
				DETAILADDR
			FROM T_FARM_MST
			WHERE 	PARTNERCD = #partnerCd#
	</select>
	
	<delete id="erpDAO.deleteFarmMstVO" parameterClass="FarmMstVO"  >
					DELETE FROM T_FARM_MST	
					WHERE 
						FARMSID = #farmSid# 
	</delete>
	
	<!-- 생산자 정보 수정  -->
	<update id="erpDAO.updateTBizPartner" parameterClass="PartnerVO">
			          UPDATE
			          			T_BIZ_PARTNER
			          SET 
							PARTNERNM =	#partnerNm#,
							PARTNERTYPECD =	#partnerTypeCd#,
							VILLAGENM =	#villageNm#,
							PARTNERCEO =	#partnerCeo#,
							BUSINESSNO =	#businessNo#,
							TELNO =	#telNo#,
							MOBILENO =	#mobileNo#,
							POSTNO =	#postNo#,
							ADDR =	#addr#,
							DETAILADDR =	#detailAddr#,
							BANKCD =	#bankCd#,
							ACCOUNTNO =	#accountNo#
				WHERE
							PARTNERCD =	#partnerCd#
	</update>
	
	<!-- 거래처 취급 상품 등록 -->
	<insert id="erpDAO.insertProdMstVO"  parameterClass="ProdMstVO">
		INSERT INTO T_BIZ_PROD
		(
			PARTNERCD,
			PRODCD,
			REGIDATE,
			REGISTER
		)
		VALUES
		(
			#partnerCd#,
			#prodCd#,
			SYSDATE,
			#register#
		)
	</insert>
	
	<!--  재배지 정보 PK -->
	<select id="erpDAO.selectFarmSidCnt"  resultClass="int" cacheModel="ERPGoodsManageManageCache">
		 SELECT TO_NUMBER(NVL (MAX (FARMSID), '0')+1)AS sidCnt
         FROM T_FARM_MST
	</select>
	<!-- 재배지 정보 insert -->
	<insert id="erpDAO.insertFarmMstVO"  parameterClass="FarmMstVO">
		INSERT INTO T_FARM_MST
		(
			FARMSID,
			PARTNERCD,
			FARMNM,
			POSTNO,
			ADDR,
			DETAILADDR
		)
		VALUES
		(
		  #farmSid#,
		  #partnerCd#,
		  #farmNm#,
		  #postNo#,
		  #addr#,
		  #detailAddr#
		)
	</insert>
	

	<delete id="erpDAO.deleteBizProd" parameterClass="ProdMstVO"  >
					DELETE FROM T_BIZ_PROD					
					WHERE 
						PARTNERCD = #partnerCd# AND PRODCD = #prodCd#
	</delete>
	
	<select id="erpDAO.actionLogin"  resultClass="loginVO" cacheModel="ERPGoodsManageManageCache">
		 	SELECT
				PARTNERCD id,
			    PARTNERNM name,
			    '' ihidNum,
			    PARTNERPW password,
			    '' email,
			    'RNR' userSe,
			    '' orgnztId,
			    PARTNERCD uniqId,
			    'P' sttusCode,
			    '' sgroupId,
			    '' passwordHint,
			    '' passwordCnsr
			FROM
				T_BIZ_PARTNER
			WHERE
				PARTNERCD = #partnerCd#
	</select>
	<select id="erpDAO.selectContractList"  parameterClass="ProdContractVO" resultClass="ProdContractVO" cacheModel="ERPGoodsManageManageCache">
		SELECT * 
		  FROM 
		       (SELECT ROWNUM RNUM, 
		              ALL_LIST.* 
		         FROM 
		              (SELECT 
							   LIST.contractSid,
							  LIST.prodCd,
							  LIST.partnerCd,
							  LIST.contractNm,
							  LIST.companyNm,
							  LIST.contractPrice,
							  LIST.contractAmt,
							  LIST.startConDate,
							  LIST.endConDate,
							  LIST.shipMentDate,
							  LIST.fileNm,
							  LIST.businessNo,
							  LIST.explaIn,
							  LIST.regiDate,
							  LIST.register,
							  (SELECT PRODNM FROM T_PROD_MST WHERE PRODCD = LIST.prodCd  )AS prodNm
		                FROM T_PROD_CONTRACT LIST
		                WHERE  
						PARTNERCD = #partnerCd#
		                 <isNotEmpty prepend="AND" property="searchKey1" >
  		     				LIST.prodCd = #searchKey1#
   						 </isNotEmpty>
   						    <isNotEmpty prepend="AND" property="searchKey2" >
  		     				LIST.companyNm LIKE '%$searchKey2$%'
  		     					
   						 </isNotEmpty>
   						    <isNotEmpty prepend="AND" property="searchKey3" >
  		     				LIST.partnerCd = #searchKey3#
   						 </isNotEmpty>
		               <isNotEmpty prepend="AND" property="searchStartDate1" >
			          		     (LIST.startConDate &gt;= #searchStartDate1# AND LIST.startConDate &lt;= #searchStartDate2#)
			            </isNotEmpty>
			            <isNotEmpty prepend="AND" property="searchEndDate1" >
			          		   (LIST.endConDate &gt;= #searchEndDate1# AND LIST.endConDate &lt;= #searchEndDate2#)
			            </isNotEmpty>
		               
		              ) ALL_LIST 
		       ) 
		 WHERE RNUM &gt; #firstIndex# AND RNUM &lt;= #firstIndex# + #recordCountPerPage# 
	</select>
	
	<select id="erpDAO.selectContractTotal"  parameterClass="ProdContractVO" resultClass="int" cacheModel="ERPGoodsManageManageCache">
	SELECT 
		COUNT(*) totcnt		
	FROM T_PROD_CONTRACT
	  WHERE  PARTNERCD = #partnerCd#
		                 <isNotEmpty prepend="AND" property="searchKey1" >
  		     				LIST.prodCd = #searchKey1#
   						 </isNotEmpty>
   						    <isNotEmpty prepend="AND" property="searchKey2" >
  		     				LIST.companyNm LIKE '%$searchKey2$%'
  		     					
   						 </isNotEmpty>
   						    <isNotEmpty prepend="AND" property="searchKey3" >
  		     				LIST.partnerCd = #searchKey3#
   						 </isNotEmpty>
		               <isNotEmpty prepend="AND" property="searchStartDate1" >
			          		     (LIST.startConDate &gt;= #searchStartDate1# AND LIST.startConDate &lt;= #searchStartDate2#)
			            </isNotEmpty>
			            <isNotEmpty prepend="AND" property="searchEndDate1" >
			          		   (LIST.endConDate &gt;= #searchEndDate1# AND LIST.endConDate &lt;= #searchEndDate2#)
			            </isNotEmpty>
	</select>
	
	<select id="erpDAO.selectContractVO"  parameterClass="ProdContractVO" resultClass="ProdContractVO" cacheModel="ERPGoodsManageManageCache">
			SELECT 
				   LIST.contractSid,
				   LIST.prodCd,
				   LIST.partnerCd,
				   LIST.contractNm,
				   LIST.companyNm,
				   LIST.contractPrice,
				   LIST.contractAmt,
				   LIST.startConDate,
				   LIST.endConDate,
				   LIST.shipMentDate,
				   LIST.fileNm,
				   LIST.businessNo,
				   LIST.explaIn,
				   LIST.regiDate,
				   LIST.register,
				   (SELECT PRODNM FROM T_PROD_MST WHERE PRODCD = LIST.prodCd  )AS prodNm
              FROM T_PROD_CONTRACT LIST
		      WHERE  
               LIST.contractSid =  #contractSid#
	</select>
	<select id="erpDAO.selectFarmingMaxId"  resultClass="long" cacheModel="ERPGoodsManageManageCache">
		SELECT
			MAX(DIARYSID)
		FROM
			T_FARMING_DIARY
	</select>
	<select id="erpDAO.selectFarmingListTotal"  parameterClass="farmingVO" resultClass="int" cacheModel="ERPGoodsManageManageCache">
		SELECT
            COUNT(*) totcnt
		FROM
			T_FARMING_DIARY DIARY
		WHERE
			DIARY.PARTNERCD = #partnerCd#
			<isNotEmpty prepend="AND" property="title" >
  		     	DIARY.TITLE LIKE '%$title$%'
   			</isNotEmpty>
   			<isNotEmpty prepend="AND" property="startDate" >
  		     	DIARY.FARMINGDATE >= #startDate#
   			</isNotEmpty>
   			<isNotEmpty prepend="AND" property="endDate" >
  		     	DIARY.FARMINGDATE &lt;= #endDate#
   			</isNotEmpty>
	</select>
	
	<select id="erpDAO.getFarming"  parameterClass="farmingVO" resultClass="farmingVO" cacheModel="ERPGoodsManageManageCache">
		SELECT
			DIARYSID diarySid,
			TITLE title,
			CONTENT content,
			PARTNERCD partnerCd,
			PARTNERNM partnerNm,
			REGIDATE regiDate,
			REGISTER register,
			FARMINGTYPECD farmingTypeCd,
			FARMINGDATE farmingDate
		FROM
			T_FARMING_DIARY
		WHERE
			PARTNERCD = #partnerCd# AND DIARYSID = #diarySid#
	</select>
	
	<select id="erpDAO.selectFarmingList"  parameterClass="farmingVO" resultClass="farmingVO" cacheModel="ERPGoodsManageManageCache">
		SELECT * 
		  FROM 
		       (SELECT ROWNUM RNUM, 
		              ALL_LIST.* 
		         FROM 
		              (
		              	SELECT
		              		DISTINCT(DIARY.DIARYSID) diarySid,
						    DIARY.TITLE title,
						    DIARY.FARMINGTYPECD farmingTypeCd,
						    DIARY.CONTENT content,
						    DIARY.FARMINGDATE farmingDate    
						FROM
							T_FARMING_DIARY DIARY
						WHERE
							DIARY.PARTNERCD = #partnerCd#
							<isNotEmpty prepend="AND" property="title" >
				  		     	DIARY.TITLE LIKE '%$title$%'
				   			</isNotEmpty>
				   			<isNotEmpty prepend="AND" property="startDate" >
				  		     	DIARY.FARMINGDATE >= #startDate#
				   			</isNotEmpty>
				   			<isNotEmpty prepend="AND" property="endDate" >
				  		     	DIARY.FARMINGDATE &lt;= #endDate#
				   			</isNotEmpty>
						ORDER BY
							DIARY.DIARYSID DESC
					) ALL_LIST 
	       ) 
		 WHERE RNUM &gt; #firstIndex# AND RNUM &lt;= #firstIndex# + #recordCountPerPage#
	</select>
	
	<insert id="erpDAO.insertFarmDiary"  parameterClass="farmingVO">
		INSERT INTO T_FARMING_DIARY
		(
			DIARYSID,
			TITLE,
			CONTENT,
			PARTNERCD,
			PARTNERNM,
			REGIDATE,
			REGISTER,
			FARMINGTYPECD,
			FARMINGDATE

		)
		VALUES
		(
			#diarySid#,
			#title#,
			#content#,
			#partnerCd#,
			#partnerNm#,
			#regiDate#,
			#register#,
			#farmingTypeCd#,
			#farmingDate#
		)
	</insert>
		
	<update id="erpDAO.updateFarmDiary"  parameterClass="farmingVO">
		UPDATE T_FARMING_DIARY
		SET
			TITLE=#title#,
			CONTENT=#content#,
			PARTNERCD=#partnerCd#,
			PARTNERNM=#partnerNm#,
			FARMINGTYPECD=#farmingTypeCd#,
			FARMINGDATE=#farmingDate#
		WHERE
			PARTNERCD = #partnerCd# AND DIARYSID = #diarySid#
	</update>
	
	<delete id="erpDAO.deleteFarmDiary"  parameterClass="farmingVO">
		DELETE FROM T_FARMING_DIARY
		WHERE
			PARTNERCD = #partnerCd# AND DIARYSID = #diarySid#
	</delete>
	

	<select id="erpDAO.selectOrderIngList"  parameterClass="OrderIngVO" resultClass="OrderIngVO" cacheModel="ERPGoodsManageManageCache">
		SELECT * 
		  FROM 
		       (SELECT ROWNUM RNUM, 
		              ALL_LIST.* 
		         FROM 
		              (SELECT 
							  ORDERINGNO,
							  PARTNERCD,
							  ORDERINGTOTPRICE,
							  INSCHEDULEDATETIME,
							  STATUSCD,
							  PURPOSECD,
							  ORDERINGDATE,
							  CANCELDATE,
							  CANCELREGISTER,
							  CANCELREASON,
							  CONFIRMDATE,
							  CONFIRMREGISTER,
							  REGIDATE,
							  REGISTER
		                FROM T_ORDERING_MAIN
		                  WHERE  PARTNERCD = #partnerCd#
		                 <isNotEmpty prepend="AND" property="searchKey1" >
  		     				ORDERINGNO = #searchKey1#
   						 </isNotEmpty>
   						    <isNotEmpty prepend="AND" property="searchKey2" >
  		     				STATUSCD = #searchKey2#
   						 </isNotEmpty>
			               <isNotEmpty prepend="AND" property="searchStartDate1" >
				          		     (ORDERINGDATE &gt;= #searchStartDate1# AND ORDERINGDATE &lt;= #searchStartDate2#)
				            </isNotEmpty>
		              ) ALL_LIST 
		       ) 
		 WHERE RNUM &gt; #firstIndex# AND RNUM &lt;= #firstIndex# + #recordCountPerPage# 
	</select>
	
	<select id="erpDAO.selectOrderIngTotal"  parameterClass="OrderIngVO" resultClass="int" cacheModel="ERPGoodsManageManageCache">
	SELECT 
		COUNT(*) totcnt		
	FROM T_ORDERING_MAIN     
	  WHERE  PARTNERCD = #partnerCd#
       <isNotEmpty prepend="AND" property="searchKey1" >
 			ORDERINGNO = #searchKey1#
	 </isNotEmpty>
	 <isNotEmpty prepend="AND" property="searchKey2" >
 			STATUSCD = #searchKey2#
	 </isNotEmpty>
     <isNotEmpty prepend="AND" property="searchStartDate1" >
      		 (ORDERINGDATE &gt;= #searchStartDate1# AND ORDERINGDATE &lt;= #searchStartDate2#)
     </isNotEmpty>     
	</select>
	
	<select id="erpDAO.selectOrderIngVO"  parameterClass="OrderIngVO" resultClass="OrderIngVO" cacheModel="ERPGoodsManageManageCache">
				SELECT 
					  ORDERINGNO,
					  PARTNERCD,
					  ORDERINGTOTPRICE,
					  INSCHEDULEDATETIME,
					  STATUSCD,
					  PURPOSECD,
					  ORDERINGDATE,
					  CANCELDATE,
					  CANCELREGISTER,
					  CANCELREASON,
					  CONFIRMDATE,
					  CONFIRMREGISTER,
					  REGIDATE,
					  REGISTER
                FROM T_ORDERING_MAIN
                  WHERE 
		          ORDERINGNO = #orderIngno#      
	</select>
	
	<select id="erpDAO.selectOrderIngCodeVO"  parameterClass="OrderIngVO" resultClass="OrderIngVO" cacheModel="ERPGoodsManageManageCache">
		SELECT 
				MAIN.ORDERINGNO,
			    MAIN.CONFIRMDATE,
			    SUB.PRODCD,
			    SUB.ORDERINGSTOCKCNT,
			    SUB.ORDERINGINCNT,
			    SUB.ORDERINGCNT,
			    SUB.UNITPRICE,
			    SUB.UNITPRICETOT,
			    SUB.INYN,
			    MST.PRODNM,
                MST.UNITCD,
                MST.STANDARD
		FROM T_ORDERING_MAIN MAIN
		INNER JOIN  T_ORDERING_SUB SUB
		ON
			MAIN.ORDERINGNO = SUB.ORDERINGNO
        INNER JOIN T_PROD_MST MST 
		 ON      SUB.PRODCD = MST.PRODCD
		WHERE
			MAIN.ORDERINGNO = #orderIngno#
	</select>
	
		<select id="erpDAO.selectOrderIngCalculateList"  parameterClass="OrderIngVO" resultClass="OrderIngVO" cacheModel="ERPGoodsManageManageCache">
	SELECT T1.CENTERINDATE, 
       T1.CENTERINNO, 
       T1.ORDERINGNO, 
       T1.PRODCD,
       T1.PRODNM, 
       T1.PURPOSE, 
       T1.PARTNERCD, 
       T1.PARTNERNM,
       T1.CENTERINCNT, 
       T1.RETURNCNT, 
       T1.UNITPRICE, 
       T1.INAMT, 
       (NVL(T1.UNITPRICE,0) * NVL(T1.RETURNCNT,0)) AS RETURNAMT, 
       NVL(T2.CHARGEPRICE,0) AS CHARGEPRICE, 
       NVL(T2.CHARGEDATE,'-') AS CHARGEDATE 
  FROM 
       (SELECT A.CENTERINDATE, 
              A.CENTERINNO, 
              A.ORDERINGNO, 
              B.PRODCD,
              C.PARTNERCD, 
              (SELECT SUBNM 
                FROM T_CODE_MST_SUB 
               WHERE C.PURPOSECD=SUBCD 
                     AND MAINCD='03' 
              ) AS PURPOSE, 
              (SELECT PARTNERNM 
                FROM T_BIZ_PARTNER 
               WHERE C.PARTNERCD=PARTNERCD 
              ) AS PARTNERNM, 
              (SELECT PRODNM 
                FROM T_PROD_MST 
               WHERE B.PRODCD=PRODCD
              ) AS PRODNM, 
              B.CENTERINCNT, 
              NVL
              (
                     (SELECT T2.RETURNCNT 
                       FROM T_RETURN_MAIN T1, 
                            T_RETURN_SUB T2 
                      WHERE T1.ORDERINGNO=A.ORDERINGNO 
                            AND T1.CENTERINNO=A.CENTERINNO 
                            AND T1.RETURNNO=T2.RETURNNO 
                            AND T2.PRODCD=B.PRODCD 
                     ),0
                 ) AS RETURNCNT, 
                 
D.UNITPRICE,
(NVL(D.UNITPRICE,0) * NVL(B.CENTERINCNT,0)) AS INAMT
FROM T_CENTER_IN_MAIN A, T_CENTER_IN_SUB B, T_ORDERING_MAIN C, T_ORDERING_SUB D
WHERE A.CENTERINNO=B.CENTERINNO AND A.ORDERINGNO=C.ORDERINGNO  AND A.ORDERINGNO=D.ORDERINGNO AND C.ORDERINGNO=D.ORDERINGNO AND B.PRODCD=D.PRODCD 
          ) T1, 
          T_ORDERING_CHARGE T2 
          WHERE T1.ORDERINGNO=T2.ORDERINGNO(+) AND T1.CENTERINNO=T2.CENTERINNO(+) AND T1.PRODCD=T2.PRODCD(+)  
           AND T1.PARTNERCD= #partnerCd#
          <!--  
          AND T1.CENTERINNO=''
        
          AND T2.CHARGEDATE IS NOT NULL
          AND  T1.CENTERINDATE BETWEEN '" + inSDate + "' AND '" + inEDate + "' ";
          -->
           ORDER BY T1.CENTERINNO ASC
	</select>
	

	<select id="erpDAO.selectFarmingSubList"  parameterClass="farmingVO" resultClass="farmingSubVO" cacheModel="ERPGoodsManageManageCache">
		SELECT
			MST.FARMSID farmSid,
			MST.FARMNM farmNm,
		    MST.ADDR addr,
		    MST.DETAILADDR detailAddr  
		FROM
			T_FARMING_DIARY_SUB SUB INNER JOIN T_FARM_MST MST
			ON SUB.FARMSID = MST.FARMSID
		WHERE
			MST.PARTNERCD = #partnerCd# AND SUB.DIARYSID = #diarySid#
	</select>

	
	<insert id="erpDAO.insertFarmDiarySub"  parameterClass="farmingVO">
		INSERT INTO T_FARMING_DIARY_SUB
		(
			DIARYSID,
			FARMSID
		)
		VALUES
		(
			#diarySid#,
			#farmSid#
		)
	</insert>
	
	<delete id="erpDAO.deleteFarmDiarySub"  parameterClass="farmingVO">
		DELETE FROM T_FARMING_DIARY_SUB
		WHERE
			DIARYSID = #diarySid#
	</delete>
		
</sqlMap>