<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="RFCBoardCateManage">
	
	<cacheModel type="${Globals.ibatis.default.cache}" id="RFCBoardCateManageCache" readOnly="true" serialize="false">
      <flushInterval hours="24" />
      	<flushOnExecute statement="boardDAO.insertBoardCategory"/>
		<flushOnExecute statement="boardDAO.updateBoardCategory"/>
		<flushOnExecute statement="boardDAO.deleteBoardCategory"/>
     </cacheModel> 
	 
	 <typeAlias  alias="egovMap"      type = "egovframework.rte.psl.dataaccess.util.EgovMap"/>
     <typeAlias  alias="boardCategoryVO" type = "egovframework.rfc3.board.vo.BoardCategoryVO"/>
	<select id="boardDAO.selectBoardCategory"  parameterClass="boardCategoryVO"  resultClass="boardCategoryVO" cacheModel="RFCBoardCateManageCache">
						SELECT
							BOARD_ID boardId,
							CATEGORY_DEPTH categoryDepth,
							CATEGORY_CODE categoryCode,
							CATEGORY_NAME categoryName,
							CATEGORY_SORT_IDX categorySortIdx
						FROM
						 	  RFC_COMTCBBSCATE
						WHERE  BOARD_ID = #boardId# AND CATEGORY_DEPTH = #categoryDepth#
						ORDER BY CATEGORY_SORT_IDX ASC						
	</select>
	
	<select id="boardDAO.getBoardCategory"  parameterClass="boardCategoryVO"  resultClass="boardCategoryVO" cacheModel="RFCBoardCateManageCache">
						SELECT
							BOARD_ID boardId,
							CATEGORY_DEPTH categoryDepth,
							CATEGORY_CODE categoryCode,
							CATEGORY_NAME categoryName,
							CATEGORY_SORT_IDX categorySortIdx
						FROM
						 	  RFC_COMTCBBSCATE
						WHERE  BOARD_ID = #boardId# AND CATEGORY_DEPTH = #categoryDepth# AND CATEGORY_CODE = #categoryCode#
	</select>
	
	<select id="boardDAO.selectBoardCategoryCount"  parameterClass="boardCategoryVO"  resultClass="int" cacheModel="RFCBoardCateManageCache">
						SELECT
							count(*) totocnt							
						FROM
						 	  RFC_COMTCBBSCATE
						WHERE  BOARD_ID = #boardId# AND CATEGORY_DEPTH = #categoryDepth# AND CATEGORY_CODE = #categoryCode#
	</select>
	
	<insert id="boardDAO.insertBoardCategory" parameterClass="boardCategoryVO">
					INSERT INTO RFC_COMTCBBSCATE
						(
							BOARD_ID,
							CATEGORY_DEPTH,
							CATEGORY_CODE,
							CATEGORY_NAME,
							CATEGORY_SORT_IDX							
						)
					VALUES
						(						
						#boardId#,
						#categoryDepth#,
						#categoryCode#,
						#categoryName#,
						#categorySortIdx#
						)
	</insert>
	
	<update id="boardDAO.updateBoardCategory" parameterClass="boardCategoryVO">
					UPDATE RFC_COMTCBBSCATE 
					SET
						BOARD_ID=#boardId#,
						CATEGORY_DEPTH=#categoryDepth#,
						CATEGORY_CODE=#categoryCode#,
						CATEGORY_NAME=#categoryName#,
						CATEGORY_SORT_IDX=#categorySortIdx#
					WHERE  BOARD_ID = #boardId# AND CATEGORY_DEPTH = #categoryDepthBefore# AND CATEGORY_CODE = #categoryCodeBefore#
	</update>
	
	<delete id="boardDAO.deleteBoardCategory" parameterClass="boardCategoryVO">
					DELETE FROM RFC_COMTCBBSCATE 
					WHERE  BOARD_ID = #boardId# AND CATEGORY_DEPTH = #categoryDepth# AND CATEGORY_CODE = #categoryCode#
	</delete>
</sqlMap>
