<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="RFCNewZipCode">
	  
     <cacheModel type="${Globals.ibatis.default.cache}" id="RFCNewZipCodeCache" readOnly="true" serialize="false">
     	<flushInterval hours="24" />
     </cacheModel>
     
     <select id="userManageDAO.searchNZipCode"  parameterClass="java.lang.String" resultClass="egovframework.rfc3.user.vo.NZipCodeVO"  cacheModel="RFCNewZipCodeCache">
							SELECT
								DISTINCT(ZIPCODE) zipcode,
								SIDO sido,
								GUGUN gugun,
								EUMYUN eumyun,
								GIL gil,
								DONG	dong
							FROM
							    RFC_COMTNEWZIPCODE_TB
							 WHERE 
							 DONG LIKE '%$dong$%' OR GIL LIKE '%$dong$%'
							 ORDER BY SIDO,GUGUN,EUMYUN,GIL,DONG
	</select>
     
      <select id="userManageDAO.searchZipCode"  parameterClass="java.lang.String" resultClass="egovframework.rfc3.user.vo.ZipCodeVO"  cacheModel="RFCNewZipCodeCache">
							SELECT
								 SEQ seq,
								 ZIPCODE zipcode,
								 SIDO sido,
								 GUGUN gugun,
								 DONG dong,
								 BUNJI bunji
							FROM
							    RFC_COMTZIPCODE_TB
							 WHERE 
							 DONG LIKE '%$dong$%'
	</select>
	
	  <select  id="userManageDAO.searchNewZipCodeCnt" parameterClass="egovframework.rfc3.user.vo.SearchNewZipCodeVO"   resultClass="int"  cacheModel="RFCNewZipCodeCache">
     		  select 
     				  	count(*) as cnt
  				from 
  						RFC_COMTNEW_ZIPCODE_TB a
  				where   1=1
  				    <isEmpty prepend="and" property="keyword">
				 	    DONG LIKE '--NoData--'
				      </isEmpty>
				     <isNotEmpty prepend="and" property="keyword">
				  	    DONG LIKE '$keyword$%' or  ROAD_NAME  LIKE '$keyword$%'  or BLDG_NAME LIKE '$keyword$%'
				     </isNotEmpty>
  						 
     </select>
     <select  id="userManageDAO.searchNewZipCode" parameterClass="egovframework.rfc3.user.vo.SearchNewZipCodeVO"   resultClass="egovframework.rfc3.user.vo.NewZipCodeVO"  cacheModel="RFCNewZipCodeCache">
    SELECT  * 
      FROM (
		SELECT ROWNUM RNUM, ALL_LIST.*  
		FROM  
		(
     		
     		select 
     				   a.CODE_DONG codeDong,
				       a.SIDO sido,
				       a.GUGUN gugun,
				       a.DONG dong,
				       a.RI ri,
				       a.CHK_MOUNTAIN chkMountain,
				       a.LOT_NUM lotNum,
				       a.LOT_SUB_NUM lotSubNum,
				       a.ROAD_CODE roadCode,
				       a.ROAD_NAME roadName,
				       a.CHK_LOWER_GROUND chkLowerGround,
				       a.BLDG_NUM bldgNum,
				       a.BLDG_SUB_NUM bldgSubNum,
				       a.BLDG_NAME bldgName,
				       a.BLDG_DETAIL_NAME bldgDetailName,
				       a.BLDG_MNO bldgMno,
				       a.DONGNO dongNo,
				       a.DONG_CODE dongCode,
				       a.DONG_NAME dongName,
				       a.ZIP_CODE zipCode,
				       a.ZIP_CODE_NO zipCodeNo
  				from 
  						RFC_COMTNEW_ZIPCODE_TB a
  				where 1=1 
  				   <isEmpty prepend="and" property="keyword">
				 	 DONG LIKE '--NoData--'
				   </isEmpty>
				   <isNotEmpty prepend="and" property="keyword">
				  	 DONG LIKE '$keyword$%' or  ROAD_NAME  LIKE '$keyword$%'  or BLDG_NAME LIKE '$keyword$%'
				  </isNotEmpty>
				  
  				  ORDER BY BLDG_MNO  asc
              ) ALL_LIST
	      )
  WHERE  RNUM  &gt; #pageIndex#
  AND  RNUM &lt;= #pageIndex# + #pageSize#  						
     </select>
    
	
</sqlMap>