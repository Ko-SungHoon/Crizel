<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="RFCResourceRoles">
	 <typeAlias  alias="egovMap"      type = "egovframework.rte.psl.dataaccess.util.EgovMap"/>
	 
	  <cacheModel type="${Globals.ibatis.default.cache}" id="RFCResourceRolesCache" readOnly="true" serialize="false">
     	<flushInterval hours="24" />
     	<flushOnExecute statement="resourceRolesDAO.insertResourceRole"/>
     	<flushOnExecute statement="resourceRolesDAO.updateResourceRole"/>
     	<flushOnExecute statement="resourceRolesDAO.deleteResourceRole"/>
     </cacheModel>
	 
	 <select id="resourceRolesDAO.selectResourceRole"  parameterClass="egovframework.rfc3.iam.vo.ResourceRolesVO"  resultClass="java.lang.Integer"  cacheModel="RFCResourceRolesCache">
	 					SELECT
							  count(*) totcnt
						FROM
							RFC_COMTNRESOURCE_ROLES
						WHERE
					
						  RESOURCE_ID=#resourceId#
	 </select>
	  <select id="resourceRolesDAO.selectResourceRoleList"  parameterClass="egovframework.rfc3.iam.vo.ResourceRolesVO"  resultClass="egovframework.rfc3.iam.vo.ResourceRolesVO"  cacheModel="RFCResourceRolesCache">
	 					SELECT
							  ROLE_ID roleId,
							  (select ROLE_NM from RFC_COMTNROLES where  ROLE_ID=A.ROLE_ID)  roleNm
						FROM
							RFC_COMTNRESOURCE_ROLES A
						WHERE
						  RESOURCE_ID=#resourceId#
	 </select>
	<insert id="resourceRolesDAO.insertResourceRole"  parameterClass="egovframework.rfc3.iam.vo.ResourceRolesVO">
					INSERT INTO RFC_COMTNRESOURCE_ROLES
						 (
						 	RESOURCE_ID,
						 	ROLE_ID
						 ) VALUES  (
							#resourceId# ,
							#roleId#
						 )
	</insert>
	<update id="resourceRolesDAO.updateResourceRole"  parameterClass="egovframework.rfc3.iam.vo.ResourceRolesVO">
					UPDATE 
						 RFC_COMTNRESOURCE_ROLES
					SET 
						 ROLE_ID=#roleId#
					WHERE
						 RESOURCE_ID=#resourceId#
						
					
	
	</update>
	<delete id="resourceRolesDAO.deleteResourceRole"  parameterClass="egovframework.rfc3.iam.vo.ResourceRolesVO">
					DELETE  FROM 
							RFC_COMTNRESOURCE_ROLES
					WHERE  	
						    RESOURCE_ID=#resourceId#
	</delete>
</sqlMap>